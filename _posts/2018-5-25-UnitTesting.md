---
layout: post
title: "单元测试"
date: 2018-5-24 18:41:12 
description: "软件测试执行过程中的第一步-单元测试"
tag: Software Testing
---

本章继续学习单元测试！

### 测试过程
测试是一个逐步扩大的过程，从最小的单元到最后的整个系统
Unit tesintf --> Integration testing --> System testing

#### 软件开发过程
软件开发过程是一个逐渐细化的过程，从单元测试到系统测试是对系统的一个逆向求证过程。
Requirement --> High-level desgin --> low-level desgin --> Code 

![process](/images/ST/UnitTesting/testprocess.png)

### 单元测试
单元测试是单独且独立地审查应用程序最小的可测试部分（单元）自身操作的软件开发过程

* 一个单元是软件设计中的最小的单元
* 一个单元可能是一个特定的函数、一个类方法、一个模块或者一组小模块

在Java中，一个单元是一个类或一个类方法
在C中，一个单元是一个函数或者子过程

* 软件单元必须和程序的其他部分分开，并进行独立地测试

#### 单元的基本特征
一般情况下，被测单元通过三种基本特征与其他单元进行隔离
* 特定的功能(Clear function)
* 与其他单元有明确的接口定义(Clear Interface definition)
* 规范定义(Specifications definition)

### 目的
* 确认编码是否与设计一致
* 跟踪需求(Requirements)和设计的实现
* 发现设计和需求之间的错误
* 发现编码过程中引入的错误

#### 注意(Attention)
* 目标：确保模块被正确编码
* 依据：系统详细的规格说明书
* 过程：一个完整的经过设计、脚本开发、执行(implementation)、调试和分析结果
* 执行者：由程序开发人员和测试人员共同完成
* 方法：以白盒测试方法为主，以黑盒测试方法为辅
* 评估：通过所用的单元测试用例，代码没有严重缺陷

### 测试过程
1. 在详细计划阶段完成单元测试计划
2. 建立单元测试环境，完成测试设计和开发
3. 执行单元测试用例，并且详细记录测试结果
4. 判定单元测试是否通过
5. 提交单元测试报告

![process](/images/ST/UnitTesting/process.png)

### 优点
* 分离程序的每个部分，展示每个部分是正确的
* 同时进行单独地测试，降低测试成本，缩短开发周期
* 便于跟踪错误
* 提供代码必须满足严格的、书面的要求(Contract)
* 能够在开发周期的早期发现问题

### 测试类型
单元测试有两种测试类型：静态测试和动态测试

#### 静态测试
* 主要针对代码进行语法检查，或手工检查代码或文档以发现错误
* 编写代码的开发人员可以单独地使用静态测试
* 检查编码标准与规范
* 使用代码评审(Code inspection)、代码审查(Code review)和代码走查(Code walkthroughs)

代码评审包括代码走查和正式会议审查<br>
代码走查和审查的区别

| 项目 |走查|审查|
|------|---|----|
|准备|通过设计和编码|应准备好需求描述文档、程序设计文档、程序源代码清单、代码编码标准和代码缺陷检查表|
|形式|非正式会议|正式会议|
|参加人员|开发人员为主|项目组成员包括测试人员|
|主要技术方法|无|缺陷检查表|
|注意事项|限时、不要现场修改代码|限时、不要现场修改代码|
|生成文档|会议记录|静态分析错误包括|
|目标|代码标准规范、无逻辑错误|代码标准规范、无逻辑错误|

### 误区
* 单元测试浪费很多时间
* 单元测试只能证明代码所做的事情
* 优秀程序员的代码不需要进行单元测试
* 集成测试能获取所有的bug
* 低成本效率

### 单元测试策略

* 桩(Stub)

桩是模拟测试模块的工作过程中调用的模块，只处理很少的数据

* 驱动(Driver)

驱动是模调用测试模块的模块，其接受测试数据并传输到相应的测试模块，以启动测试模块和得到相应的结果

![unit](/images/ST/UnitTesting/unit.png)

#### 自顶向下测试
首先测试顶层模块，把顶层模块调用的单元作为桩进行测试，然后继续测试下一层模块，把已被测试过的单元作为驱动进行测试，依此向下，直到测试完毕

#### 自底向上测试
首先测试低层模块，为底层模块设置驱动进行测试，然后测试上一层模块，把已被测试过的单元当成桩，依此向上，直到测试完毕

#### 独立测试
不考虑模块之间的关系，为每个模块都设置桩和驱动

### 测试分析
单元测试需要考虑“度”的问题，下面是一些考虑的层面
* 部分的数据结构
* 错误处理
* 独立路径
* 边界条件
* 模块界面

给单元测试加上一些限制，有利于发挥单元测试的威力，为代码重构和提高代码质量提供动力<br>
Geotechnical提供了内部单元测试的准则，下面列举一些准则

* 保证单元测试经可能小而快
* 单元测试应该全自动化且互不影响
* 单元测试可以简单地运行
* 使用覆盖分析评估测试
* 立即修复失败的测试用例的代码

### JUnit
单元测试一般采用白盒测试用法，针对程序内部的实现来完成测试<br>
单元测试工具震度不同的语言有不同的版本，典型工具是xUnit工具家族