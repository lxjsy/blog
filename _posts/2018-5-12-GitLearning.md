---
layout: post
title: "Git版本库创建和版本修改"
date: 2017-10-11 9:01:10 
description: "Git学习"
tag: Git
---

本章记录在[廖雪峰老师的Git教程](https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000)的指导下在Windows中Git的使用！
Windows上的Git可以在官方网站上下载应用程序进行安装。

### 创建版本库

#### 概念
版本库又名仓库，英文名repository，你可以简单理解成一个目录。
这个目录里面的所有文件都可以被Git管理起来，
每个文件的修改、删除，Git都能跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻可以“还原”。

#### 初始化及文件提交
在系统中创建一个文件夹来作为git的仓库，当然可以创建创库，输入`git init`指令，对仓库进行初始化!
这个目录就变成Git可以管理的仓库，在目录中多出了一个`.git`的隐藏文件（Windows中可以通过`查看`中勾选`隐藏的项目`来查看），是Git用来跟踪管理版本库的文件。

#### 添加文件到Git仓库
添加文件到Git仓库，分两步：
* 第一步，使用命令`git add <file>`，可以反复使用添加多个文件。
* 第二步，使用命令`git commit`,加上`-m xxx`来添加评论，表明本次动作的行为

### 仓库管理

#### 仓库文件状态
* 使用命令`git status`随时掌握工作区的状态，了解工作区的变动。
* 使用命令`git diff <file>`查看被修改但未提交文的件内容

#### 版本回退
Git可以在文件修改到一定程度的时候，可以保存一个快照，这个快照在Git中被称为commit。如果出现文件混乱，或者误删文件，可以从最近的一个`commit`恢复，然后继续工作，而不是把之前的工作全丢弃。
使用命令`git log`显示从最到最远的提交日志，可以加上`---pretty=oneline`来简化信息的输出。
实际上，每提交一个新版本，Git会把他们自动串成一条时间线（类似链表），`commit id`是Git在使用分布式版本控制系统的版本号。
在时间线上，`HEAD`表示当前版本，`HEAD^`表示上个版本，`HEAD~n`来表示前n个版本。
* 使用命令`git reset --hard <version>`来进回退版本
* 使用命令`git reflog`来记录每一次命令，在通过上述命令回退到未来版本

#### 工作区与暂缓区
这个部分要重点理解
![工作区与暂缓区](images/git/workandstage.png)
* 工作区（Working Directory）：电脑中能看到的目录
* 版本库（Repository）：包括缓存区（stage/index）和分支

在Git中往版本库添加文件，分两部执行：
第一步是用命令`git add`添加文件，实际上是把文件添加到暂存区；
第二步是用命令`git commit`提交修改，实际上是把暂存区的所有内容提交到当前分支（`master`，后面详细介绍）。
当完成提交之后，如果工作区没有做任何修改，那么工作区就是干净的；如果没有提交，在进行远程创库push时，显示的是`Everything is update`表示没有文件修改。

#### 管理修改
Git管理的修改，而非文件，当对同一次文件执行两次修改时，执行如下的顺序：
第一次修改->`git add`->第一次修改->`git commit`
因为Git管理的是修改，当执行命令`git add`时，在工作区的第一次修改被存入暂存区，但是第二次修改没有被放入暂存区，所以git只会提交第一次修改。如果需要提交第二次修改，先使用命令`git add`，再一起提交。

#### 撤销修改
* 当该乱工作区某个文件的时候，想直接丢弃工作区的修改时，使用命令`git checkout -- <file>`
注意：`git checkout -- <file>`有两种意思
一是`<file>`自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；
二是已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。
* 如果出现了上述的第二种情况，想丢弃修改，分两步，第一步用命令`git reset HEAD file`，就回到了把暂存区的修改回退到工作区，第二步按上述操作
* 如果已经提交了不合适的版本，想要测小本次提交，可以使用命令`git reset --hard <version>`来进回退版本

#### 文件删除
当文件删除之后，Git会检测到工作区与版本库不一致，有以下两种步骤可以选择
* 如果要与工作区同步，则使用命令`git rm <file>`和`git commit -m xxx`从版本库删除该文件
* 使用是误删文件，则使用命令`git checkout -- <file>`恢复文件到最新版本，即用版本库替换工作区版本












