---
layout: post
title: "白盒测试"
date: 2018-5-24 15:53:10 
description: "白盒测试"
tag: Software Testing
---

本章学习软件测试中的白盒测试方法！

### 白盒测试
* 软件工程师测试代码是否符合预期的验证技术
* 深入考虑系统和组件的内部机制
* 需要对软件产品内部工作有充分的了解，特别是代码结构和代码逻辑
* 又称结构化测试(Structural testing),清箱测试(Clear box testing),玻璃盒测试(Glass box testing)

### 测试类型
白盒测试主要用于单元测试，包括静态白盒测试和动态白盒测试

#### 静态白盒测试
代码审查、静态结构分析、静态质量度量方法

#### 动态白盒测试
基于覆盖(coverage)的测试，尽可能覆盖程序的结构特征和逻辑路径
逻辑覆盖、循环覆盖、基本路径覆盖

### 原则
* 模块中的所有独立路径(All independent path)必须至少是实现一次
* 所有逻辑值(logic value)都需要实现true和false两个值
* 检查程序的内部数据结构，确保其结构的有效性
* 运行操作范围内的所有循环
* 穷举测试不可取

#### 不可使用穷举(exhaustive)测试
* 路径穷举测试方法不能检测程序本身是否违反设计规范（即使是一个错误的程序）
* 路径穷举测试过程由于路径的省略而不能检测出错误
* 路径穷举测试不能发现与数据相关的一些错误

### 四代白盒测试
* 第一代白盒测试

测试开发初期；
使用调试、维护和打印语句

* 第二代白盒测试

操作通过正式的语言(测试脚本)；
测试脚本被组合到测试用例中，测试用例被组合到测试集，使用测试工程来管理测试集；
使用代码覆盖率评估测试结果；
RTRT，代码测试，视觉测试器，C++测试器等等

* 第三代白盒测试 

解决了重复测试的问题，测试模式从一次性过渡到继续测试模式

* 第四代白盒测试 

在线测试、回合测试、持续测试

### 逻辑覆盖测试

[logic coverage](images/ST/WhiteTesing/logiccoverage.png)

#### 语句覆盖(Statement coverage)
语句覆盖设计一系列测试用例，让程序所有可执行语句至少实现一次

* 缺点
无法发现判断语句中的`逻辑操作错误`和其他不包含所有可执行语句的路径错误

#### 判定覆盖(Decison coverage)
判定覆盖设计一系列测试用例，让程序判断语句的真假分支至少实现一次/每个判定获得一种可能的结果至少一次

* 缺点
判定覆盖不能保证可以发现在判断语句中错误的条件

#### 条件覆盖（Condition coverage）
条件覆盖设计一些列测试用例，，让程序判断分支中每一个条件的取值都至少实现一次

#### 条件判定覆盖(Condition/decision coverage)
条件判定覆盖设计充分的测试用例，让程序每个判断分支的可能取值和每一个条件的可能取值都至少实现一次

#### 条件组合覆盖(Condition combination coverage)
条件组合判定覆盖设计充分的测试用例，使每个判断的所有可能的条件组合至少实现一次

* 满足条件组合覆盖，一定满足判定覆盖、条件覆盖和条件判定覆盖

#### 路径覆盖
路径覆盖设计足够的测试用例，覆盖程序所有可能的路径

### N-S garph
计算逻辑覆盖最小测试数量使用N-S图

结构化程序有3种控制结构组成
* 顺序型-构成串行结构
* 选择型-构成分支结构
* 重复性-构成循环结构

[NS](images/ST/WhiteTesing/NS.png)
从最内层往外层计算，最内层为最小无相等的层次的结构使用加法计算次数，并列层次结构使用乘法

### 控制流图
控制流图在用来描述程序的结构性程序流程图基础上，通过简化图形符号，突出程序的控制流结构

[contral flow graph](images/ST/WhiteTesing/graph.png)

* 简化的控制流图
在判断语句中，不具体考虑所有的条件，仅用一个标记符号表示

* 详细的控制流图
在判断语句中，考虑所有的条件，用多个带`.`标记符号表示

### 基本路径测试
McCade提出的测试方法，旨在推导出程序设计中的逻辑复杂度，并用其定义包含一组基本执行路径的基本集，测试用例至少执行基本执行路径集中每一条语句一次

#### 基本复杂度/圈复杂度(Cyclomatic Complexity)
逻辑复杂度的量化值，这个值给出了基本集独立路径的数量，以及测试数量的上限，以确保每个条件的每个语句和两边都至少执行一次，一个独立的路径是通过一个程序的任何路径，它至少引入了一组新的处理语句（如一个新节点）或一个新条件（如,一个新的边)。

计算方法
* #边数 - #节点数 + #端点节点数(terminal vertices) (通常是2) 
* #出度为2的节点数(Predicate Nodes) + 1 
* 控制流图的区域数(Number of regions of flow graph).(注意外圈)

### 测试用例设计
* 绘制控制流图
* 确定圈复杂度
* 写出所有独立路径
* 根据独立路径

### 循环测试
只关注控制流图中循环结构的有效性，有四种类型循环

#### 简单循环
测试用例设计
* 跳过循环
* 循环执行一次
* 循环执行两次
* 循环执行m次（典型次数） 
如果存在循环上界n
* 循环循环n-1, n, n+1次

#### 嵌套循环
* 从最内层的循环开始，将所有其他循环设置为最小值
* 对最内部的循环进行简单的循环测试，同时保持外部循环最小迭代参数（如循环计数器）值
* 向外层进行下一个回路测试，但是将所有其他的外部循环保持在最小值和其他嵌套循环中，以达到“典型”值
* 直到所有的循环被执行

#### 连接循环
连接循环中的每一个循环可以归为简单循环或嵌套循环

#### 非结构化循环
如果有可能，应该重新设计这类型的循环

### Z路径覆盖法
Z 路径覆盖法是一种将程序中循环结构简化成选择结构的测试方法。
循环简化的目的是限制循环次数，无论循环的形式和循环体实际执行的次数，简化后的循环测试只考虑循环一次或者零次两种情况。
在这种情况下，循环与判定分支的效果是一样的，即循环要么执行，要么跳过。

### 数据流测试
数据流测试方法根据定义的位置和程序中变量的使用选择程序的测试路径

数据流测试可以检测由于编码错误而导致的数据值的不当使用
* 不正确的赋值或输入语句
* 定义缺失（零定义的使用）
* 谓词是错误的（错误的路径会导致错误的定义）

### 变异测试(mutation testing)
突变测试是基于错误的测试技术，用于衡量软件测试的质量。突变测试通常对程序的源代码或者目标代码做小的改动，并把截然不同的错误行为（或者怪异行为）作为预期。如果测试代码没有觉察到这种小改动带来的错误，就说明这个测试是有问题的。

#### 使用范围
* 帮助测试人员设计高质量测试用例
* 评估已有测试用例质量