---
layout: post
title: "集成测试"
date: 2018-5-26 14:34:25 
description: "软件测试过程中的集成测试"
tag: Software Testing
---

本章继续学习单元测试！

### 集成测试(Integration Testing)
集成测试位于单元测试到系统测试的过渡阶段，在单元测试的基础上，将所有模块按照概要设计要求组装成子系统或系统，进行集成测试

#### 适用范围
* 单元或者模块构成一个组件
* 组件构成一个系统
* 系统构成一个产品
* 介于单元测试和系统测试的测试

#### 主要任务
一些模块虽然能够单独的工作，但并不能保证连接起来也能正常工作，因此有必要进行集成测试，发现并排除模块连接过程中可能发生的问题，最终构成要求的软件子系统或系统

* 模块间接口

连接各个模块时，穿越模块接口的数据时候是否丢失

* 模块功能特征

各个子功能组合起来，能否达到预期要求的功能

* 交互协议和消息

一个模块的功能是否会对另一个模块产生不利的影响

* 系统架构

全局数据结构是否有问题，会不会被异常修改

#### 目的
验证模块组装后，功能、性能、可靠性需求是否满足系统的高层设计（架构设计）

#### 三种主要测试对比

|测试类型|对象|目的|测试依据|测试方法|
|-------|----|---|--------|-------|
|单元测试|模块内部的程序错误|消除局部模块功能或逻辑上的错误和缺陷|模块逻辑设计，模块外部说明|大量采用白盒测试方法|
|集成测试|模块间的集成和调用关系|找出与软件设计相关的程序结构，模块调用关系，模块接口方面的问题|程序结构设计|结合使用白盒与黑盒测试方法，较多采用黑盒测试方法(有时称灰盒测试)|
|系统测试|整个系统，包括系统中的软硬件等|对整个系统进行一系列的整体、有效测试|系统结构设计，目标说明书，需求说明书等|黑盒测试|

### 优点
* 软件缺陷能够较早地被检测出来
* 容易修复被检测的软件缺陷
* 能够较早地获得有关各个模块和整个系统的健康性和可接受性的反馈意见
* 灵活安排软件缺陷修复，可以与开放并行

### 特点
* 单元测试具有不彻底性，无法检测模块间接口信息内容的正确性、相互调用关系是否符合设计

只能依靠集成测试来保证

* 同系统测试相比，集成测试用例是从程序结构出发的，目的性、针对性更强

测试项发现问题的效率更高，定位问题的效率也较高

* 能够较容易地测试到系统测试用例难以模拟的特殊异常流程

从纯理论的角度来讲，集成测试能够模拟所有实际情况

* 定位问题较快

### 集成测试方式与步骤

#### 方式
集成测试是以一系列测试循环增量的方式进行，在每个测试周期中，一些模块与现有测试版本进行集成，循环构建直到整个系统可以用于系统测试

#### 步骤
1. 设计一个测试计划
2. 设计测试用例和准备测试数据
3. 在适合的情况下，创建脚本运行测试用例
4. 组件被整合之后，执行测试用例
5. 修复错误并重新检查代码
6. 重复测试循环，直到所有组件成功集成

#### 结束标志
* 系统全部整合在一起
* 测试用例全部执行完毕
* 所有类型的缺陷已经被修复

#### 循环数量
由以下参数决定
* 系统中的模块数
* 模块的相对复杂度（圈复杂度）
* 模块间接口的相对复杂度

#### 测试时间
* 每个测试循环中需要被集成的模块数量
* 被集成模块是否已经进行过充分测试
* 每个测试-调试-修复周期的周转时间

### 集成测试的层次
* 模块内集成
这种形式的测试构成了低层次的集成测试，其目标是将模块组合在一起构建一个内聚系统

* 子系统内集成
这是一个高级测试阶段，需要连接独立测试的系统

* 子系统间集成（Pairwise testing）
在成对集成中，一次只能测试整个系统中的两个互联系统，成对测试的目的是确保考虑中的两个系统可以一起工作，假设整个环境中的其他系统按照预期行事

### 集成策略
集成测试的基本策略比较多，分类复杂，基本可以分为以下两类
* 非递增集成测试策略--一气呵成
通过不增量测试，软件模块被组合并随机测试

* 渐进式集成策略--逐渐实现
增量测试逐渐扩展了集成模块

### 大爆炸集成(Big Bang integration)
大爆炸集成是属于非增值式集成的一种方法<br>
它把所有的系统组件一次性集合到被测试系统中，不考虑组件之间的相互依赖性或者可能存在的风险

#### 优点
* 可以迅速完成集成测试，并且只要极少数的驱动和桩模块
* 多个测试人员可以并行工作，对人力、物力资源利用率较高

#### 缺点
* 发现错误时，定位和修改比较困难
* 许多接口错误很容易躲过测试而进入系统测试

#### 使用范围
* 维护型项目
* 经过充分单元测试的小型系统
* 每个开发阶段的质量和单元测试质量都相当高

### 自顶向下集成(Top-down integration)
1. 首先集中于顶层的组件，然后逐步测试处于底层的组件
2. 该方式可以采用深度优先策略和广度优先策略
3. 进行回归测试，排除集成过程中引起错误的可能
4. 判断是否所有的模块都已集成到系统中，是则结束测试，否则转到2去执行

当桩模块不能正确的向上传递有用信息，可以采用一些解决办法
* 将很多测试推迟到桩模块用实际模块代替了之后进行。
* 进一步开发能模拟实际模块功能的桩模块。
* 自底向上集成和测试软件

当桩模块不能正确的向上传递有用信息，可以采用一些解决办法：
* 将很多测试推迟到装模块用实际模块代替了之后进行。
* 进一步开发能模拟实际模块功能的桩模块。
* 自底向上集成和测试软件

#### 优点
* 较早的验证了主要的控制和判断点
* 如果按深度方向组装，可以首先实现和验证一个完整的软件功能
* 最多只需一个驱动模块
* 支持故障隔离

#### 缺点
* 桩的开发和维护成本较大
* 底层组件的无法预计的需求可能会导致许多顶层组件的修改

#### 使用范围
* 产品的控制结构比较清晰和稳定
* 产品的高层接口变化比较小
* 产品的底层接口未定义或经常可能被修改
* 产品的控制模块具有较大的技术风险，需要尽早被验证

### 自底向上集成(Buttom-up integration)
从具有最小依赖性的底层组件开始，按照依赖关系的结构，逐层向上集成，以检测整个系统的稳定性

1. 对于给定层次的模块，它的子模块（包括子模块的下属模块）已经组装并测试完成，所以不再需要桩
2. 从底层模块开始，也可以把两个或多个叶子模块合并到一起进行测试
3. 开发驱动模块对上面的模块进行测试，用实际模块代替驱动模块，与已测子模块一起组成大模块进行测试。
4. 重复这一过程直到顶层模块测试完成

#### 优点
* 允许对底层模块行为进行早期验证，可以在任何一个叶子节点已经就绪的情况下进行集成测试
* 减少了桩模块的工作量
* 支持故障隔离

#### 缺点
* 驱动模块的开发工作量比较庞大
* 对高层的验证被推迟到了最后，设计上的错误不能被及时发现
* 底层的异常比较难覆盖

#### 适用范围
底层接口比较稳定，高层接口变化比较频繁的产品

### 三明治集成(Sandwich integration)
综合自顶向下的集成测试策略和自底向上集成测试策略优点

#### 优点
具有自顶向下和自底向上两种集成策略的优点

#### 缺点
中间层在被集成前测试不充分

#### 适用范围
大部分软件开发项目都是用这种集成策略

### 分层集成(Layers integration)
通过增量式集成的方法验证一个具体层次体系结构的应用系统的稳定性和可互操作性

#### 策略
1. 划分系统的层次
2. 确定每个层次内部的集成策略
3. 确定层次间的集成策略

#### 适用范围
* 通信类软件
* 有明显层次关系的产品系统

### 高频集成(High-frequency integration)
频繁将新代码加入到一个已经稳定的基线中，以免集成故障难以发现，同时控制可能出现的基线偏差

#### 策略
* 开发人员完成要提供的代码的增量部分，同时测试人员完成相关的测试包
* 集成测试人员将开发人员修改或增加的组件集中起来形成一个新的集成体，并且在上面运行集成后的测试包
* 评价结果

#### 优点
* 可有效防止错误
* 严重错误、遗漏和不正确的假设能被较早的发现
* 错误定位比较容易。
* 桩代码和驱动代码的开发量减少
* 开发和集成可同时进行

#### 缺点
* 刚开始的几个周期可能不易于平稳集成
* 高频集成的频率需要有个好的把握

#### 使用范围
采用迭代过程模型开发的产品

### 基于事件(消息)的集成(Event-based Integration)
从验证消息路径的正确性出发，渐进式的把系统集成到一起，从而验证系统的稳定性

#### 策略
* 从系统的外部看，分析系统可能输入的消息集
* 选取一条消息，分析其穿越的模块
* 集成这些模块进行消息接口测试
* 重复上面的步骤，直到所有的消息都被测试过

#### 优点
* 验证一条消息时，可能同时需要多个模块，因此进度上要快一些
* 减少驱动模块的开发

#### 缺点
* 对于复杂的系统，消息之间的相互关联性可能是错综复杂并难以分析的。
* 对一些接口测试不够充分

#### 适用范围
* 面向对象的系统
* 基于有限状态机的嵌入式系统

### 集成测试分析
集成测试的分析工作类似与概要设计对详细设计的作用，它直接知道了集成测试用例的设计，在整个集成测试过程中占据最关键的地位

#### 体系结构设计
* 从需求的跟踪实现出发，划分出系统实现上的结构层次
* 找出系统组件之间的依赖关系
* 目的：找出集成测试的粒度，即基础模块的大小

#### 模块分析
* 明确本次测试的模块
* 找出模块之间的关系，将关系最密切的模块首先集成在一起
* 依次集成模块之间耦合度较低的模块

#### 接口分析
1. 接口的划分
确定系统、子系统和模块的边界
确定模块内部、子系统内部、系统内部的接口
确定模块间、子系统间的接口
确定系统与操作系统、硬件以及第三方软件的接口

2. 接口的分类：
函数接口
消息接口
类接口

3. 接口数据分析
分析穿越接口的数据
函数接口关注参数的个数、顺序、属性等
消息接口关注消息的类型、消息的域等
类接口关注类的属性和行为

#### 可测性分析
主要关注随着集成范围的增加而导致的可测试性下降，因此要充分关注不可测试的接口，尽可能早的找到解决方案

#### 集成测试策略分析
好的集成测试策略主要关注
* 能够对被测对象进行比较充分的测试，尤其是关键模块
* 能够使模块和接口的划分清晰明了
* 投入的资源被充分利用

#### 常见的集成测试故障
* 配置/版本控制错误
* 遗漏、重叠或冲突的函数
* 文件或数据库使用不正确或不一致
* 错误的对象和消息的绑定
* 错误的参数或不正确的参数值
* 组件之间的冲突
* 资源竞争

### 测试用例设计
集成测试应用的是介于白盒和黑盒之间的灰盒测试技术，在测试用例设计中要综合使用白盒和黑盒测试方法

#### 用于系统设计测试用例的操作

#### 对于系统设计测试用例操作
集成测试的一个需要关注的问题是接口能用，并且不会阻滞后续的集成测试执行。因此可以根据这个原则设计一些基本功能的测试用例来进行最低功能限度的验证

* 等价类划分方法
* 规范导出法

根据相应的规范描述来设计测试用例。每个测试用例被用来测试一个或多个规范陈述句，基本上是根据陈述规范所用语句的顺序来设计相应测试用例。这个方法在用例和规范陈述之间做到了很好的对应。加强了规范的可读性和可维护性，是一种正向的测试技术，需要逆向的测试技术对测试用例进行补充。当规范中的某种情形需要不同的处理的时候，每个陈述句可能需要多个用例

#### 设计测试用例以进行正面测试
接口的设计以及模块功能设计需求是明确的、无误的，测试的重点在于验证接口的需求和集成后而模块功能被正确无误的满足了，根据概要设计文档导出相关测试用例

方法：标准输出方法、输入测试、输出覆盖法、等价类划分、状态转换

#### 设计反向测试的测试用例
规格中可能出现的接口遗漏或接口定义错误，分析可能出现的接口异常情况，包括接口数据本身的错误，接口数据顺序错误

方法：错误猜测法、基于风险测试、基于错误测试、边界值分析、特殊值测试、状态转换方法

#### 根据特殊要求设计测试用例
安全性能测试、性能测试、可靠性测试等应该在系统测试阶段进行，但有一些产品在模块设计文档中就明确了这些指标，那就应该尽早展开接口这些特殊需求的测试

#### 设计满足覆盖率的测试用例
功能覆盖、接口覆盖，测试重点要突出，关键的接口必须被覆盖到

#### 试案例补充
功能的增加、特性修改、缺陷修改

### 集成测试过程
根据IEEE的软件验证和确认计划指南
* 计划阶段
* 设计阶段
* 实现阶段
* 执行阶段

#### 集成测试环境
对于简单系统来说（单进程软件），集成测试环境与单元测试环境比较类似
集成测试环境也很复杂，需要依赖一些商用测试工具或测试仪，有时还需要开发一些接口模拟工具
* 硬件环境
* 操作环境
* 数据库环境
* 网络环境

### 集成测试原则
* 关键模块必须充分测试。
* 所有接口必须被测试到。
* 集成测试应该按一定的层次进行
* 当接口发生修改时，涉及的相关接口都必须进行回归测试
* 集成测试需要按计划进行，防止测试的随意性
* 集成测试的策略应该综合考虑质量、成本和进度三者之间的关系